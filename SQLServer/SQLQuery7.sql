USE Exportaciones
SELECT * FROM eef_2007_2017
SELECT * FROM tc_entidad
SELECT * FROM tc_scian

CREATE VIEW ESTADOS
AS SELECT DISTINCT * FROM eef_2007_2017 
   WHERE eef_2007_2017.E03=28 OR eef_2007_2017.E03=19 OR eef_2007_2017.E03=5 OR eef_2007_2017.E03=8 OR eef_2007_2017.E03=26

CREATE VIEW TOTALES_ESTADO
AS  SELECT DISTINCT E03, ANIO, SUM(eef_2007_2017.VAL_USD) AS TOTAL FROM eef_2007_2017
	WHERE eef_2007_2017.ANIO >= 2015 AND eef_2007_2017.ANIO<=2017
	GROUP BY  ANIO,E03

CREATE VIEW TOTALES_SCIAN
AS	SELECT DISTINCT CODIGO_SCIAN, ANIO, SUM(eef_2007_2017.VAL_USD) AS TOTAL FROM eef_2007_2017
	WHERE eef_2007_2017.ANIO >= 2012 AND eef_2007_2017.ANIO<=2017
	GROUP BY  ANIO,CODIGO_SCIAN

SELECT * FROM ESTADOS
SELECT * FROM TOTALES_ESTADO
SELECT * FROM TOTALES_SCIAN

SELECT tc_entidad.NOM_ENTIDAD, TOTALES_ESTADO.ANIO, TOTALES_ESTADO.TOTAL 
FROM TOTALES_ESTADO INNER JOIN tc_entidad
ON TOTALES_ESTADO.E03 = tc_entidad.E03
ORDER BY tc_entidad.NOM_ENTIDAD