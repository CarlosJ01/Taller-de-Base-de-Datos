-- Carlos Jahir Castro Cázares
-- SQLServer
USE bd_medico;

-- INSERT
--INSERT INTO "nombre_tabla" ("columna1", "columna2", ...) VALUES ("valor1", "valor2", ...);
	-- TABLA ENFERMEDAD
		INSERT INTO ENFERMEDAD(ENFERMEDAD) VALUES('GRIPE');
		INSERT INTO ENFERMEDAD(ENFERMEDAD) VALUES('DIABETES');
		INSERT INTO ENFERMEDAD(ENFERMEDAD) VALUES('ASMA');
		INSERT INTO ENFERMEDAD(ENFERMEDAD) VALUES('OBESIDAD');
		INSERT INTO ENFERMEDAD(ENFERMEDAD) VALUES('CANCER');

		--TABLA ALERGIA
		INSERT INTO ALERGIA(NOMBRE_ALERGIA) VALUES('ACAROS');
		INSERT INTO ALERGIA(NOMBRE_ALERGIA) VALUES('POLEN');
		INSERT INTO ALERGIA(NOMBRE_ALERGIA) VALUES('GATOS');
		INSERT INTO ALERGIA(NOMBRE_ALERGIA) VALUES('MANI');
		INSERT INTO ALERGIA(NOMBRE_ALERGIA) VALUES('AGUA');

		--TABLA ESTUDIO
		INSERT INTO ESTUDIO(NOMBRE_ESTUDIO) VALUES('GENERAL');
		INSERT INTO ESTUDIO(NOMBRE_ESTUDIO) VALUES('SANGRE');
		INSERT INTO ESTUDIO(NOMBRE_ESTUDIO) VALUES('ORINA');
		INSERT INTO ESTUDIO(NOMBRE_ESTUDIO) VALUES('ESES');
		INSERT INTO ESTUDIO(NOMBRE_ESTUDIO) VALUES('VISTA');

		--TABLA CIRUJUA
		INSERT INTO CIRUGIA(CIRUGIA) VALUES('APENDICECTOMÍA');
		INSERT INTO CIRUGIA(CIRUGIA) VALUES('HERNIAS');
		INSERT INTO CIRUGIA(CIRUGIA) VALUES('HEMORROIEDCTOMÍA');
		INSERT INTO CIRUGIA(CIRUGIA) VALUES('BIOPSIAS');
		INSERT INTO CIRUGIA(CIRUGIA) VALUES('CORAZON');

		--TABLA MEDICAMENTO
		INSERT INTO MEDICAMENTO(NOMBRE) VALUES('PARACETAMOL');
		INSERT INTO MEDICAMENTO(NOMBRE) VALUES('IBUPROFENO');
		INSERT INTO MEDICAMENTO(NOMBRE) VALUES('ANTIVIOTICO');
		INSERT INTO MEDICAMENTO(NOMBRE) VALUES('GOTAS');
		INSERT INTO MEDICAMENTO(NOMBRE) VALUES('ANTIVIRAL');
		
		--TABLA COLONIA
		INSERT INTO COLONIA(NOMBRE_COLONIA) VALUES('ADOLFO LOPEZ MATEOS');
		INSERT INTO COLONIA(NOMBRE_COLONIA) VALUES('RUIZ CORTINEZ');
		INSERT INTO COLONIA(NOMBRE_COLONIA) VALUES('MORELOS');
		INSERT INTO COLONIA(NOMBRE_COLONIA) VALUES('VILLAS DEL PEGREGAL');
		INSERT INTO COLONIA(NOMBRE_COLONIA) VALUES('ROSAS');

		--TABLA POBLACION
		INSERT INTO POBLACION(NOMBRE_POBLACION) VALUES('MORELIA');
		INSERT INTO POBLACION(NOMBRE_POBLACION) VALUES('ZAMORA');
		INSERT INTO POBLACION(NOMBRE_POBLACION) VALUES('PURUANDIRO');
		INSERT INTO POBLACION(NOMBRE_POBLACION) VALUES('URUAPAN');
		INSERT INTO POBLACION(NOMBRE_POBLACION) VALUES('QUIROGA');

		--TABLA MUNICIPIO
		INSERT INTO MUNICIPIO(NOMBRE_MUNICIPIO) VALUES('MORELIA');
		INSERT INTO MUNICIPIO(NOMBRE_MUNICIPIO) VALUES('URUAPAN');
		INSERT INTO MUNICIPIO(NOMBRE_MUNICIPIO) VALUES('HUETAMO');
		INSERT INTO MUNICIPIO(NOMBRE_MUNICIPIO) VALUES('LAZARO CARDENAZ');
		INSERT INTO MUNICIPIO(NOMBRE_MUNICIPIO) VALUES('ZAMORA');

		--TABLA ESTADO
		INSERT INTO ESTADO(NOMBRE_ESTADO) VALUES('MICHOACAN');
		INSERT INTO ESTADO(NOMBRE_ESTADO) VALUES('MONTEREY');
		INSERT INTO ESTADO(NOMBRE_ESTADO) VALUES('JALISCO');
		INSERT INTO ESTADO(NOMBRE_ESTADO) VALUES('DISTRITO FEDERAL');
		INSERT INTO ESTADO(NOMBRE_ESTADO) VALUES('GUERRERO');

		--TABLA TIPO DE PACIENTE
		INSERT INTO TIPO_PACIENTE(TIPO_PACIENTE) VALUES('ASEGURADO');
		INSERT INTO TIPO_PACIENTE(TIPO_PACIENTE) VALUES('PARTICULAR');
		INSERT INTO TIPO_PACIENTE(TIPO_PACIENTE) VALUES('POPULAR');
		INSERT INTO TIPO_PACIENTE(TIPO_PACIENTE) VALUES('GENERICO');
		INSERT INTO TIPO_PACIENTE(TIPO_PACIENTE) VALUES('PUBLICO');

		--TABLA OCUPACION
		INSERT INTO OCUPACION(NOMBRE_OCUPACION) VALUES('INGENIERO');
		INSERT INTO OCUPACION(NOMBRE_OCUPACION) VALUES('MAESTRO');
		INSERT INTO OCUPACION(NOMBRE_OCUPACION) VALUES('DOCTOR');
		INSERT INTO OCUPACION(NOMBRE_OCUPACION) VALUES('POLICIA');
		INSERT INTO OCUPACION(NOMBRE_OCUPACION) VALUES('LICENCIADO');

		--TABLA PACIENTE
		INSERT INTO PACIENTE(NOMBRES,APATERNO,AMATERNO,CALLE,NUMERO,FECHA_NACIMIENTO,TEL_FIJO,TEL_TRABAJO,TEL_CELULAR,SEXO,EMAIL,RFC,FECHA_ALTA,ESTATUS,IDPOBLACION,IDMUNICIPIO,IDCOLONIA,IDESTADO,IDOCUPACION,IDTIPO_PACIENTE)
		VALUES('CARLOS', 'CASTRO', 'CAZARES', 'UNIDAD TLATELOLCO', 136, '03/09/1998', '4431221076', '4431221076', '4431221076', 'M', 'CARLOSJ.CASTROC.01@GMAIL.COM', '1234567890121', '03/01/2018', 'A', 1, 1, 1, 1, 1, 1);		
		INSERT INTO PACIENTE(NOMBRES,APATERNO,AMATERNO,CALLE,NUMERO,FECHA_NACIMIENTO,TEL_FIJO,TEL_TRABAJO,TEL_CELULAR,SEXO,EMAIL,RFC,FECHA_ALTA,ESTATUS,IDPOBLACION,IDMUNICIPIO,IDCOLONIA,IDESTADO,IDOCUPACION,IDTIPO_PACIENTE)
		VALUES('EREN', 'EGER', 'ACKERMAN', 'DISTRITO SHINGASINA', 465, '04/05/1970', '4466870498', '4466870498', '4466870498', 'M', 'TITANATACK@GMAIL.COM', '1234567890122', '04/03/2018', 'A', 1, 3, 5, 3, 4, 2);		
		INSERT INTO PACIENTE(NOMBRES,APATERNO,AMATERNO,CALLE,NUMERO,FECHA_NACIMIENTO,TEL_FIJO,TEL_TRABAJO,TEL_CELULAR,SEXO,EMAIL,RFC,FECHA_ALTA,ESTATUS,IDPOBLACION,IDMUNICIPIO,IDCOLONIA,IDESTADO,IDOCUPACION,IDTIPO_PACIENTE)
		VALUES('CHRISTA', 'HISTORIA', 'REISS', 'PARAISO', 76, '11/27/2000', '5467983603', '5467983603', '5467983603', 'F', 'matehistoria@GMAIL.COM', '1234567890123', '12/20/2018', 'A', 5, 5, 5, 5, 5, 5);		
		INSERT INTO PACIENTE(NOMBRES,APATERNO,AMATERNO,CALLE,NUMERO,FECHA_NACIMIENTO,TEL_FIJO,TEL_TRABAJO,TEL_CELULAR,SEXO,EMAIL,RFC,FECHA_ALTA,ESTATUS,IDPOBLACION,IDMUNICIPIO,IDCOLONIA,IDESTADO,IDOCUPACION,IDTIPO_PACIENTE)
		VALUES('SERENA', 'KALOS', 'PEÑAS', 'LUMINALIA', 100, '03/07/2001', '4476230587', '4476230587', '4476230587', 'F', 'FRENEKING@GMAIL.COM', '1234567890124', '05/25/2018', 'A', 2, 1, 3, 1, 4, 2);
		INSERT INTO PACIENTE(NOMBRES,APATERNO,AMATERNO,CALLE,NUMERO,FECHA_NACIMIENTO,TEL_FIJO,TEL_TRABAJO,TEL_CELULAR,SEXO,EMAIL,RFC,FECHA_ALTA,ESTATUS,IDPOBLACION,IDMUNICIPIO,IDCOLONIA,IDESTADO,IDOCUPACION,IDTIPO_PACIENTE)
		VALUES('BRUNO', 'HOEMM', 'NORMAN', 'VILLA RAIZ', 3, '09/03/1998', '4455992376', '4455992376', '4455992376', 'M', 'spetilea@GMAIL.COM', '1234567890125', '11/01/2018', 'A', 2, 1, 4, 1, 3, 4);
		INSERT INTO PACIENTE(NOMBRES,APATERNO,AMATERNO,CALLE,NUMERO,FECHA_NACIMIENTO,TEL_FIJO,TEL_TRABAJO,TEL_CELULAR,SEXO,EMAIL,RFC,FECHA_ALTA,ESTATUS,IDPOBLACION,IDMUNICIPIO,IDCOLONIA,IDESTADO,IDOCUPACION,IDTIPO_PACIENTE)
		VALUES('AURA', 'ABEDUL', 'HOEMM', 'VILLA RAIZ', 2, '09/03/1998', '4458670987', '4458670987', '4458670987', 'F', 'TORCHIT@GMAIL.COM', '1234567890126', '12/03/2018', 'I', 3, 1, 3, 1, 3, 3);
		INSERT INTO PACIENTE(NOMBRES,APATERNO,AMATERNO,CALLE,NUMERO,FECHA_NACIMIENTO,TEL_FIJO,TEL_TRABAJO,TEL_CELULAR,SEXO,EMAIL,RFC,FECHA_ALTA,ESTATUS,IDPOBLACION,IDMUNICIPIO,IDCOLONIA,IDESTADO,IDOCUPACION,IDTIPO_PACIENTE)
		VALUES('ANAKING', 'SKY', 'WALKER', 'TATUIN', 198, '05/24/1970', '4455679854', '4455679854', '4455679854', 'M', 'ELSENADO@GMAIL.COM', '1234567890127', '01/01/2018', 'I', 2, 1, 5, 1, 5, 4);

		--TABLA FACTURA
		INSERT INTO FACTURA(IDFACTURA,FECHA,IDPACIENTE) VALUES(3455769,'10/01/2018',1);
		INSERT INTO FACTURA(IDFACTURA,FECHA,IDPACIENTE) VALUES(6786903,'11/23/2018',4);
		INSERT INTO FACTURA(IDFACTURA,FECHA,IDPACIENTE) VALUES(3128579,'01/30/2019',3);
		INSERT INTO FACTURA(IDFACTURA,FECHA,IDPACIENTE) VALUES(3128580,'02/15/2019',3);
		INSERT INTO FACTURA(IDFACTURA,FECHA,IDPACIENTE) VALUES(3128581,'03/01/2019',3);

		--TABLA HISTORIA_CLINICA
		INSERT INTO HISTORIA_CLINICA(IDPACIENTE,FECHA_ALTA,ESTATURA) VALUES(1,'03/01/2018',1.85);
		INSERT INTO HISTORIA_CLINICA(IDPACIENTE,FECHA_ALTA,ESTATURA) VALUES(2,'04/03/2018',1.67);
		INSERT INTO HISTORIA_CLINICA(IDPACIENTE,FECHA_ALTA,ESTATURA) VALUES(3,'12/20/2018',1.70);
		INSERT INTO HISTORIA_CLINICA(IDPACIENTE,FECHA_ALTA,ESTATURA) VALUES(4,'05/25/2018',1.50);
		INSERT INTO HISTORIA_CLINICA(IDPACIENTE,FECHA_ALTA,ESTATURA) VALUES(5,'11/01/2018',1.67);

		--TABLA HISTORIA_ENFERNEDAD
		INSERT INTO HISTORIA_ENFERMEDAD(ID_HISTORIA_CLINICA,IDENFERMEDAD) VALUES(2,2);
		INSERT INTO HISTORIA_ENFERMEDAD(ID_HISTORIA_CLINICA,IDENFERMEDAD) VALUES(2,3);
		INSERT INTO HISTORIA_ENFERMEDAD(ID_HISTORIA_CLINICA,IDENFERMEDAD) VALUES(1,1);
		INSERT INTO HISTORIA_ENFERMEDAD(ID_HISTORIA_CLINICA,IDENFERMEDAD) VALUES(3,5);
		INSERT INTO HISTORIA_ENFERMEDAD(ID_HISTORIA_CLINICA,IDENFERMEDAD) VALUES(4,5);

		--TABLA HISTORIA_CIRUGIA
		INSERT INTO HISTORIA_CIRUGIA(ID_HISTORIA_CLINICA,IDCIRUGIA) VALUES(3,1);
		INSERT INTO HISTORIA_CIRUGIA(ID_HISTORIA_CLINICA,IDCIRUGIA) VALUES(5,2);
		INSERT INTO HISTORIA_CIRUGIA(ID_HISTORIA_CLINICA,IDCIRUGIA) VALUES(4,4);
		INSERT INTO HISTORIA_CIRUGIA(ID_HISTORIA_CLINICA,IDCIRUGIA) VALUES(5,5);
		INSERT INTO HISTORIA_CIRUGIA(ID_HISTORIA_CLINICA,IDCIRUGIA) VALUES(4,2);
		
		--TABLA HISTORIA_ALERGIA
		INSERT INTO HISTORIA_ALERGIA(ID_HISTORIA_CLINICA,IDALERGIA) VALUES(1,2);
		INSERT INTO HISTORIA_ALERGIA(ID_HISTORIA_CLINICA,IDALERGIA) VALUES(3,5);
		INSERT INTO HISTORIA_ALERGIA(ID_HISTORIA_CLINICA,IDALERGIA) VALUES(4,2);
		INSERT INTO HISTORIA_ALERGIA(ID_HISTORIA_CLINICA,IDALERGIA) VALUES(5,3);
		INSERT INTO HISTORIA_ALERGIA(ID_HISTORIA_CLINICA,IDALERGIA) VALUES(2,4);

		--TABLA CITA
		INSERT INTO CITA(IDPACIENTE,FECHA_CITA,SINTOMAS,DIAGNOSTICO,FECHA_DIAGNOSTICO,FECHA_PROX_CITA,PAGO,PRESION_ARTERIAL,TEMPERATURA,OXIGENACION,PESO)
		VALUES(1,'01/03/2019','No se','Que va aser','01/03/2019','02/15/2019',100,50,35,34,102);
		INSERT INTO CITA(IDPACIENTE,FECHA_CITA,SINTOMAS,DIAGNOSTICO,FECHA_DIAGNOSTICO,FECHA_PROX_CITA,PAGO,PRESION_ARTERIAL,TEMPERATURA,OXIGENACION,PESO)
		VALUES(5,'01/15/2019','Se ve chido','Esta hermoso','01/15/2019','02/02/2019',300,50,35,34,70);
		INSERT INTO CITA(IDPACIENTE,FECHA_CITA,SINTOMAS,DIAGNOSTICO,FECHA_DIAGNOSTICO,FECHA_PROX_CITA,PAGO,PRESION_ARTERIAL,TEMPERATURA,OXIGENACION,PESO)
		VALUES(1,'02/15/2019','Otra ves este','No se','02/15/2019','03/01/2019',100,50,35,34,80);
		INSERT INTO CITA(IDPACIENTE,FECHA_CITA,SINTOMAS,DIAGNOSTICO,FECHA_DIAGNOSTICO,FECHA_PROX_CITA,PAGO,PRESION_ARTERIAL,TEMPERATURA,OXIGENACION,PESO)
		VALUES(1,'03/01/2019','Para que viene','Ya mejor no lo atiendo','03/01/2019','12/31/2019',200,50,35,34,70);
		INSERT INTO CITA(IDPACIENTE,FECHA_CITA,SINTOMAS,DIAGNOSTICO)
		VALUES(2,'03/30/2019','Se murio','Bien muerto');

		--TABLA CITA_ESTUDIO
		INSERT INTO CITA_ESTUDIO(IDCITA,IDESTUDIO) VALUES(3,1);
		INSERT INTO CITA_ESTUDIO(IDCITA,IDESTUDIO) VALUES(3,2);
		INSERT INTO CITA_ESTUDIO(IDCITA,IDESTUDIO) VALUES(5,5);
		INSERT INTO CITA_ESTUDIO(IDCITA,IDESTUDIO) VALUES(5,3);
		INSERT INTO CITA_ESTUDIO(IDCITA,IDESTUDIO) VALUES(5,4);

		--TABLA CITA_MEDICAMENTO_ANTERIOR
		INSERT INTO CITA_MEDICAMENTO_ANTERIOR(IDCITA,IDMEDICAMENTO) VALUES(2,1);
		INSERT INTO CITA_MEDICAMENTO_ANTERIOR(IDCITA,IDMEDICAMENTO) VALUES(4,1);
		INSERT INTO CITA_MEDICAMENTO_ANTERIOR(IDCITA,IDMEDICAMENTO) VALUES(5,1);
		INSERT INTO CITA_MEDICAMENTO_ANTERIOR(IDCITA,IDMEDICAMENTO) VALUES(5,3);
		INSERT INTO CITA_MEDICAMENTO_ANTERIOR(IDCITA,IDMEDICAMENTO) VALUES(5,4);

		--TABLA CITA_MEDICACMENTO_NUEVO
		INSERT INTO CITA_MEDICAMENTO_NUEVO(IDCITA,IDMEDICAMENTO) VALUES(2,2);
		INSERT INTO CITA_MEDICAMENTO_NUEVO(IDCITA,IDMEDICAMENTO) VALUES(4,2);
		INSERT INTO CITA_MEDICAMENTO_NUEVO(IDCITA,IDMEDICAMENTO) VALUES(5,2);
		INSERT INTO CITA_MEDICAMENTO_NUEVO(IDCITA,IDMEDICAMENTO) VALUES(5,5);
		INSERT INTO CITA_MEDICAMENTO_NUEVO(IDCITA,IDMEDICAMENTO) VALUES(5,3);

-- UPDATE Y DELETE
-- Sintaxis
-- UPDATE
	-- UPDATE nombre_tabla SET columna1 = valor1, columna2 = valor2 WHERE columna3 = valor3
	UPDATE PACIENTE SET CALLE='Calle del IMSS' where IDPACIENTE=1;
	UPDATE PACIENTE SET NUMERO=200 where IDPACIENTE=1;
	UPDATE PACIENTE SET TEL_CELULAR='4433556677' where IDPACIENTE=1;
	UPDATE CITA SET PAGO=1000 WHERE IDPACIENTE=2 AND IDCITA=5;
	UPDATE FACTURA SET IDFACTURA='23214352' WHERE IDPACIENTE=3 AND FECHA = '2019-01-30';

-- DELETE
	-- DELETE FROM nombre_tabla WHERE nombre_columna = valor 
	DELETE FROM CITA_MEDICAMENTO_ANTERIOR WHERE IDCITA=5;
	DELETE FROM CITA_MEDICAMENTO_NUEVO WHERE IDCITA=5;
	DELETE FROM CITA_ESTUDIO WHERE IDCITA=5;
	DELETE FROM CITA WHERE IDCITA=5;
	DELETE FROM FACTURA WHERE IDPACIENTE = 3 AND IDFACTURA = 23214352;


-- JOIN
	--INFORMACION DE UN PACIENTE
	SELECT NOMBRES, APATERNO, AMATERNO, NOMBRE_COLONIA, CALLE, NUMERO, NOMBRE_ESTADO, NOMBRE_MUNICIPIO, NOMBRE_POBLACION, FECHA_NACIMIENTO, TEL_FIJO, TEL_TRABAJO, TEL_CELULAR, SEXO, EMAIL, RFC, NOMBRE_OCUPACION, FECHA_ALTA, ESTATUS, TIPO_PACIENTE 
	FROM PACIENTE INNER JOIN POBLACION ON PACIENTE.IDPOBLACION = POBLACION.IDPOBLACION
	INNER JOIN MUNICIPIO ON PACIENTE.IDMUNICIPIO = MUNICIPIO.IDMUNICIPIO
	INNER JOIN COLONIA ON PACIENTE.IDCOLONIA = COLONIA.IDCOLONIA
	INNER JOIN ESTADO ON PACIENTE.IDESTADO = ESTADO.IDESTADO
	INNER JOIN OCUPACION ON PACIENTE.IDOCUPACION = OCUPACION.IDOCUPACION
	INNER JOIN TIPO_PACIENTE ON PACIENTE.IDTIPO_PACIENTE = TIPO_PACIENTE.IDTIPO_PACIENTE;

	--PACIENTES CON FACTURA Y SIN ELLA
	SELECT NOMBRES, APATERNO, AMATERNO, IDFACTURA FROM PACIENTE LEFT JOIN FACTURA ON PACIENTE.IDPACIENTE = FACTURA.IDPACIENTE;

	-- CITAS DEL PACIENTE 1
	SELECT (NOMBRES +' '+ APATERNO +' '+ AMATERNO) AS NOMBRE, FECHA_CITA, SINTOMAS, DIAGNOSTICO, FECHA_DIAGNOSTICO, FECHA_PROX_CITA, PAGO, PRESION_ARTERIAL, TEMPERATURA, OXIGENACION, PESO 
	FROM PACIENTE INNER JOIN CITA ON PACIENTE.IDPACIENTE = CITA.IDPACIENTE
	WHERE PACIENTE.IDPACIENTE = 1;

	--HISTORIAL CLINICOS
	SELECT (NOMBRES +' '+ APATERNO +' '+ AMATERNO) AS NOMBRE, HISTORIA_CLINICA.FECHA_ALTA, CIRUGIA, NOMBRE_ALERGIA 
	FROM PACIENTE JOIN HISTORIA_CLINICA ON PACIENTE.IDPACIENTE = HISTORIA_CLINICA.IDPACIENTE
	JOIN HISTORIA_CIRUGIA ON HISTORIA_CLINICA.ID_HISTORIA_CLINICA = HISTORIA_CIRUGIA.ID_HISTORIA_CLINICA
	JOIN CIRUGIA ON HISTORIA_CIRUGIA.IDCIRUGIA =  CIRUGIA.IDCIRUGIA
	JOIN HISTORIA_ALERGIA ON HISTORIA_CLINICA.ID_HISTORIA_CLINICA = HISTORIA_ALERGIA.ID_HISTORIA_CLINICA
	JOIN ALERGIA ON HISTORIA_ALERGIA.IDALERGIA = ALERGIA.IDALERGIA;

	--MEDICAMENTOS RECETADOS A LOS PACIENTES DE MORELIA Y MICHOACAN
	SELECT (NOMBRES +' '+ APATERNO +' '+ AMATERNO) AS NOMBRE, MEDICAMENTO.NOMBRE AS NOMBRE FROM 
	(SELECT * FROM PACIENTE WHERE IDESTADO = 1 AND IDMUNICIPIO = 1) AS MORE_MICH
	JOIN CITA ON MORE_MICH.IDPACIENTE = CITA.IDCITA
	JOIN CITA_MEDICAMENTO_NUEVO ON CITA.IDCITA = CITA_MEDICAMENTO_NUEVO.IDCITA
	JOIN CITA_MEDICAMENTO_ANTERIOR ON CITA.IDCITA = CITA_MEDICAMENTO_ANTERIOR.IDCITA
	JOIN MEDICAMENTO ON CITA_MEDICAMENTO_ANTERIOR.IDMEDICAMENTO = MEDICAMENTO.IDMEDICAMENTO OR CITA_MEDICAMENTO_NUEVO.IDMEDICAMENTO = MEDICAMENTO.IDMEDICAMENTO;

-- GROUP BY
	--NUMERO DE PACIENTE ACTIVOS E INACTIVOS
	-- A-> ACTIVO
	-- I-> INACTIVO
	SELECT ESTATUS, COUNT(ESTATUS) AS NUMERO FROM PACIENTE
	GROUP BY ESTATUS;

	--TOTAL QUE A PAGADO UN PACIENTE EN CITAS
	SELECT (NOMBRES +' '+ APATERNO +' '+ AMATERNO) AS NOMBRE, SUM(PAGO) AS PAGO FROM PACIENTE JOIN CITA ON PACIENTE.IDPACIENTE = CITA.IDPACIENTE
	GROUP BY NOMBRES, APATERNO, AMATERNO;


-- COUNT()
	-- NUMERO DE VECES QUE SE RECETO UN MEDICAMENTO
	SELECT MEDICAMENTO.NOMBRE, COUNT(*) AS RESETO FROM CITA JOIN CITA_MEDICAMENTO_NUEVO ON CITA.IDCITA = CITA_MEDICAMENTO_NUEVO.IDCITA
	JOIN CITA_MEDICAMENTO_ANTERIOR ON CITA.IDCITA = CITA_MEDICAMENTO_ANTERIOR.IDCITA
	JOIN MEDICAMENTO ON CITA_MEDICAMENTO_ANTERIOR.IDMEDICAMENTO = MEDICAMENTO.IDMEDICAMENTO OR CITA_MEDICAMENTO_NUEVO.IDMEDICAMENTO = MEDICAMENTO.IDMEDICAMENTO
	GROUP BY MEDICAMENTO.NOMBRE;

-- VISTAS
	--INFORMACION DE LOS PACIENTES ACTIVOS
	CREATE VIEW PACIENTES_ACTIVOS
	AS	SELECT PACIENTE.IDPACIENTE, NOMBRES, APATERNO, AMATERNO, NOMBRE_COLONIA, CALLE, NUMERO, NOMBRE_ESTADO, NOMBRE_MUNICIPIO, NOMBRE_POBLACION, FECHA_NACIMIENTO, TEL_FIJO, TEL_TRABAJO, TEL_CELULAR, SEXO, EMAIL, RFC, NOMBRE_OCUPACION, FECHA_ALTA, TIPO_PACIENTE 
		FROM PACIENTE INNER JOIN POBLACION ON PACIENTE.IDPOBLACION = POBLACION.IDPOBLACION
		INNER JOIN MUNICIPIO ON PACIENTE.IDMUNICIPIO = MUNICIPIO.IDMUNICIPIO
		INNER JOIN COLONIA ON PACIENTE.IDCOLONIA = COLONIA.IDCOLONIA
		INNER JOIN ESTADO ON PACIENTE.IDESTADO = ESTADO.IDESTADO
		INNER JOIN OCUPACION ON PACIENTE.IDOCUPACION = OCUPACION.IDOCUPACION
		INNER JOIN TIPO_PACIENTE ON PACIENTE.IDTIPO_PACIENTE = TIPO_PACIENTE.IDTIPO_PACIENTE
		WHERE ESTATUS = 'A';

	--INFORMACION DE LOS PACIENTES INACTIVOS
	CREATE VIEW PACIENTES_INACTIVOS
	AS	SELECT PACIENTE.IDPACIENTE, NOMBRES, APATERNO, AMATERNO, NOMBRE_COLONIA, CALLE, NUMERO, NOMBRE_ESTADO, NOMBRE_MUNICIPIO, NOMBRE_POBLACION, FECHA_NACIMIENTO, TEL_FIJO, TEL_TRABAJO, TEL_CELULAR, SEXO, EMAIL, RFC, NOMBRE_OCUPACION, FECHA_ALTA, TIPO_PACIENTE 
		FROM PACIENTE INNER JOIN POBLACION ON PACIENTE.IDPOBLACION = POBLACION.IDPOBLACION
		INNER JOIN MUNICIPIO ON PACIENTE.IDMUNICIPIO = MUNICIPIO.IDMUNICIPIO
		INNER JOIN COLONIA ON PACIENTE.IDCOLONIA = COLONIA.IDCOLONIA
		INNER JOIN ESTADO ON PACIENTE.IDESTADO = ESTADO.IDESTADO
		INNER JOIN OCUPACION ON PACIENTE.IDOCUPACION = OCUPACION.IDOCUPACION
		INNER JOIN TIPO_PACIENTE ON PACIENTE.IDTIPO_PACIENTE = TIPO_PACIENTE.IDTIPO_PACIENTE
		WHERE ESTATUS = 'I';

	--FACTURAS DE LOS PACIENTES
	CREATE VIEW FACTURAS
	AS	SELECT PACIENTE.IDPACIENTE, IDFACTURA AS FACTURA, FACTURA.FECHA, (NOMBRES +' '+ APATERNO +' '+ AMATERNO) AS NOMBRE, NOMBRE_COLONIA AS COLONIA, CALLE, NUMERO, RFC 
		FROM PACIENTE JOIN FACTURA ON PACIENTE.IDPACIENTE = FACTURA.IDPACIENTE
		JOIN COLONIA ON PACIENTE.IDPACIENTE = COLONIA.IDCOLONIA;

	--ESTUDIOS REALIZADOS A LOS PACIENTES
	CREATE VIEW ESTUDIOS_REALIZADOS
	AS	SELECT PACIENTE.IDPACIENTE, (NOMBRES +' '+ APATERNO +' '+ AMATERNO) AS NOMBRE, ESTUDIO.NOMBRE_ESTUDIO FROM PACIENTE JOIN CITA ON PACIENTE.IDPACIENTE = CITA.IDPACIENTE
		JOIN CITA_ESTUDIO ON CITA_ESTUDIO.IDCITA = CITA.IDCITA
		JOIN ESTUDIO ON ESTUDIO.IDESTUDIO = CITA_ESTUDIO.IDESTUDIO;

	--CITAS
	CREATE VIEW INFO_CITAS
	AS SELECT PACIENTE.IDPACIENTE, (NOMBRES +' '+ APATERNO +' '+ AMATERNO) AS NOMBRE, FECHA_CITA, SINTOMAS, DIAGNOSTICO, FECHA_DIAGNOSTICO, FECHA_PROX_CITA, PAGO, PRESION_ARTERIAL, TEMPERATURA, OXIGENACION, PESO 
		FROM PACIENTE INNER JOIN CITA ON PACIENTE.IDPACIENTE = CITA.IDPACIENTE;

-- INSTRUCCION CON VISTA
	--BUSCAR LA INFORMACION PERSONAL DE UN PACIENTE
	SELECT * FROM PACIENTES_ACTIVOS
	WHERE NOMBRES='CARLOS' AND APATERNO='CASTRO' AND AMATERNO ='CAZARES';

	--BUSCAR LAS CITAS DE UN PACIENTES
	SELECT * FROM INFO_CITAS WHERE NOMBRE='CARLOS CASTRO CAZARES';